# Fail2ban filter for nginx HTTP flood protection
# Blocks IPs making too many requests in a short time

[Definition]
failregex = ^<HOST> -.*"(GET|POST|HEAD|PUT|DELETE|PATCH|OPTIONS|CONNECT|TRACE).*" (4|5)\d\d
            ^<HOST> -.*"(GET|POST|HEAD|PUT|DELETE|PATCH|OPTIONS|CONNECT|TRACE).*" 200
            ^<HOST> -.*".*" 404
            ^<HOST> -.*".*" 403

ignoreregex =

[Init]
# Specify the name of the log files that contain relevant lines for this filter
# Can be overridden with the "logpath" option in the jail configuration
datepattern = ^%%d/%%b/%%Y:%%H:%%M:%%S

# Notes:
# This filter detects:
# - HTTP error responses (4xx, 5xx)
# - Suspicious patterns that may indicate flooding
# - 404 and 403 errors which might indicate scanning
